# Руководство по внесению изменений

## Начало работы

1. Форкните репозиторий
2. Клонируйте форк:
```bash
git clone https://github.com/YOUR_USERNAME/wh2.git
cd wh2
```

3. Создайте виртуальное окружение:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/MacOS
venv\Scripts\activate  # для Windows
```

4. Установите зависимости:
```bash
pip install -r requirements.txt
```

5. Создайте файл `.env` на основе `.env.example`

## Структура проекта

```
wh2/
├── app/
│   ├── bot.py           # Основной файл бота
│   ├── models/          # Модели данных
│   ├── handlers/        # Обработчики команд
│   ├── middleware/      # Middleware компоненты
│   ├── utils/           # Вспомогательные утилиты
│   └── validators/      # Валидаторы входных данных
├── tests/               # Тесты
├── docs/               # Документация
└── scripts/            # Вспомогательные скрипты
```

## Процесс разработки

1. Создайте новую ветку для вашей задачи:
```bash
git checkout -b feature/your-feature-name
```

2. Внесите необходимые изменения

3. Убедитесь, что код соответствует стандартам:
```bash
flake8
black .
isort .
```

4. Запустите тесты:
```bash
pytest
```

5. Закоммитьте изменения:
```bash
git add .
git commit -m "Описание изменений"
```

6. Отправьте изменения в свой форк:
```bash
git push origin feature/your-feature-name
```

7. Создайте Pull Request

## Правила оформления кода

1. Используйте типизацию
2. Пишите документацию к классам и методам
3. Следуйте PEP 8
4. Максимальная длина строки: 100 символов
5. Используйте f-строки вместо `.format()` или `%`
6. Добавляйте тесты для нового функционала

## Правила коммитов

1. Используйте понятные сообщения коммитов
2. Начинайте с глагола в повелительном наклонении
3. Первая строка - краткое описание
4. При необходимости добавляйте подробное описание после пустой строки

Примеры:
```
Add user timezone support
Fix rate limiter bug in middleware
Update weekly report generation logic
```

## Тестирование

1. Модульные тесты:
```bash
pytest tests/test_models.py
pytest tests/test_validators.py
```

2. Тесты с покрытием:
```bash
pytest --cov=app tests/
```

3. Тесты middleware:
```bash
pytest tests/test_middleware.py
```

## CI/CD

1. GitHub Actions запускает:
- Проверку стиля кода
- Тесты
- Проверку типов
- Сборку документации

2. Успешное прохождение всех проверок обязательно для принятия PR

## Документация

1. Обновляйте API.md при изменении интерфейсов
2. Добавляйте примеры использования
3. Документируйте изменения в CHANGELOG.md

## Безопасность

1. Не коммитьте чувствительные данные
2. Используйте переменные окружения
3. Проверяйте зависимости на уязвимости:
```bash
safety check
```

## Оптимизация

1. Профилируйте код при подозрении на проблемы производительности
2. Используйте асинхронные операции где возможно
3. Оптимизируйте запросы к базе данных

## Мониторинг

1. Используйте структурированное логирование
2. Добавляйте метрики для нового функционала
3. Обновляйте health check при добавлении новых компонентов

## Релизы

1. Обновляйте версию в setup.py
2. Добавляйте тег версии:
```bash
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0
```

## Контакты

По вопросам разработки обращайтесь:
- Создавайте Issue в репозитории
- Обсуждайте в Discussions
- Присоединяйтесь к чату разработчиков 